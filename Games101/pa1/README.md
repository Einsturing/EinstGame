### 透视矩阵推导

$(x,y,z)\rightarrow(x',y',z')$，根据相似三角形，有$y'=\frac{n}{z}y,x'=\frac{n}{z}x$

所以
$$
\left(
\begin{array}{c}
x\\
y\\
z\\
1
\end{array}
\right)\Rightarrow
\left(
\begin{array}{c}
nx/z\\
ny/z\\
unknown\\
1
\end{array}
\right)==
\left(
\begin{array}{c}
nx\\
ny\\
unknown\\
z
\end{array}
\right)
$$
于是
$$
M^{(4\times4)}_{p\rightarrow o}
\left(
\begin{array}{c}
x\\
y\\
z\\
1
\end{array}
\right)=
\left(
\begin{array}{c}
nx\\
ny\\
unknown\\
1
\end{array}
\right)
$$
设
$$
M_{p\rightarrow o}=
\left(
\begin{array}{c}
n&0&0&0\\
0&n&0&0\\
?&?&?&?\\
0&0&1&0
\end{array}
\right)
$$
已知近平面上的点经过透视投影后不变，有
$$
\left(
\begin{array}{c}
x\\
y\\
n\\
1
\end{array}
\right)\Rightarrow
\left(
\begin{array}{c}
x\\
y\\
n\\
1
\end{array}
\right)==
\left(
\begin{array}{c}
nx\\
ny\\
n^2\\
n
\end{array}
\right)
$$


已知远平面的中心点经过透视投影后不变，有
$$
\left(
\begin{array}{c}
0\\
0\\
f\\
1
\end{array}
\right)\Rightarrow
\left(
\begin{array}{c}
0\\
0\\
f\\
1
\end{array}
\right)==
\left(
\begin{array}{c}
0\\
0\\
f^2\\
f
\end{array}
\right)
$$
设第三行为$(0, 0, A, B)$，有方程$An+B=n^2,Af+B=f^2$

解方程得$A=n+f,B=-nf$